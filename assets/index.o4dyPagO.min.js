import{j as e}from"./icons.DHZLH5cu.min.js";import{r as m,R as D}from"./index.C8ayVwQI.min.js";import{r as F,u as T,l as E,f as C,O as z,a as P,b as v,m as O,C as B,F as N,g as U,c as L,d as k,e as q,h as $,i as V,j as A,k as H,R as Q,n as G,N as M,P as W,o as Y}from"./ContactDetail.DosxcL4c.min.js";import{S as j,s as J,i as K,r as X}from"./Global.DZzDGABG.min.js";import{c as Z}from"./redux-toolkit.modern.DURh381R.min.js";import{c as ee,a as te,p as ae}from"./productSlice.2IG3lGDg.min.js";import{B as g,I as f}from"./edit.BIHAj60A.min.js";import"./customerUtils.C7O5_bBb.min.js";import{c as se,a as re}from"./customerUtils.CvkgFsrJ.min.js";import"./_commonjsHelpers.Cpj98o6Y.min.js";import"./contactsLoader.El1tzQ7g.min.js";import"./index.BYzmSUuc.min.js";import"./index.Bb4qSo10.min.js";import"./utils.CHtjtCvc.min.js";var y={},b=F;y.createRoot=b.createRoot,y.hydrateRoot=b.hydrateRoot;m.createContext(null);m.createContext(null);const ne=Z({reducer:{contacts:ee,customers:te,products:ae}});function I(){const a=T();return console.error(a),m.useEffect(()=>(a?document.getElementById(j).classList.add("error-state"):document.getElementById(j).classList.remove("error-state"),()=>{document.getElementById(j).classList.remove("error-state")}),[a]),e.jsx("div",{id:"error-page",children:e.jsxs("p",{children:["React Errors:  ",e.jsx("i",{children:a.statusText||a.message})]})})}async function oe({request:a,params:s}){try{const r=new URL(a.url).searchParams.get("q");return await E(),{contacts:await C(r),q:r}}catch(t){throw new Error("contactsLoader() issue: ",t)}}async function ie({request:a,params:s}){try{const r=new URL(a.url).searchParams.get("q");return await E(),{contacts:await C(r),q:r}}catch(t){throw new Error("contactsLoader() issue: ",t)}}const ce="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let R=(a=21)=>{let s="",t=crypto.getRandomValues(new Uint8Array(a));for(;a--;)s+=ce[t[a]&63];return s};async function S({params:a}){const s=await U(a.contactId);if(!s)throw new Response("",{status:404,statusText:"Contact Not Found"});return{contact:s}}async function le({request:a,params:s}){let t=await a.formData();return L(s.contactId,{favorite:t.get("favorite")==="true"})}function de(){const{setOutletState:a}=m.useContext(z),{contact:s}=P(),[t,r]=m.useState(),{placeholderImages:l,imageLoadingError:o}=v(n=>n.contacts);m.useEffect(()=>{if(!s||!s.avatar){console.log("====> contact or contact.avatar undefined ");return}return r(s.avatar.trim()),()=>{}},[s.avatar,s]);const c=m.useCallback(()=>{try{let n=t;if(!n||n.trim()==="")return l["ppl-1"].src;if(J(n)&&K(n)){let i=n;return i=X(i),l[i]}else return t}catch(n){return console.error("Error getting placeholder imgs:",n),""}},[t]);return o?e.jsxs("div",{children:["Error loading images: ",o.message]}):e.jsxs(O.div,{id:"contact",className:"detail_section",children:[e.jsx("div",{className:"detail_img_wrapper",children:t&&t.trim()!==""?e.jsx("img",{className:"detail_img_main",src:c().src||t,srcSet:c().srcset,sizes:"(max-width: 500px) 480px, 100vw",loading:"lazy"},t):e.jsx(B,{className:" text-slate-200 w-full h-full"})}),e.jsxs("div",{className:"detail_info_wrapper",children:[e.jsxs("h1",{className:"section_heading flex",children:[s.first||s.last?e.jsxs(e.Fragment,{children:[s.first," ",s.last]}):e.jsx("i",{children:"No Name"})," ",e.jsx(me,{contact:s,className:"ml-4 test1"})]}),s.twitter&&e.jsx("p",{children:e.jsx("a",{target:"_blank",href:`https://twitter.com/${s.twitter}`,className:"pl-0",children:s.twitter})}),s.notes&&e.jsx("p",{children:s.notes}),e.jsxs("div",{className:"contact-btn-wrapper my-4 flex",children:[e.jsx(N,{action:"edit",children:e.jsx(g,{className:" text-contrast2 ",type:"submit",size:"xl",children:"Edit"})}),e.jsx(N,{method:"post",action:"destroy",onSubmit:n=>{confirm("Please confirm you want to delete this record.")||n.preventDefault(),a("")},children:e.jsx(g,{className:"ml-4  text-contrast2 ",type:"submit",size:"xl",children:"Delete"})})]})]})]},`${s.id}`)}function me({contact:a,className:s}){const t=k();let r=a.favorite;return t.formData&&(r=t.formData.get("favorite")==="true"),e.jsx(t.Form,{method:"post",className:s,children:e.jsx("button",{name:"favorite",value:r?"false":"true","aria-label":r?"Remove from favorites":"Add to favorites",children:r?"★":"☆"})})}async function he({request:a,params:s}){const t=await a.formData(),r=Object.fromEntries(t);return await L(s.contactId,r),$(`/contacts/${s.contactId}`)}function pe(){const{contact:a}=P(),s=q();return e.jsx("div",{className:"detail_section contact-edit",children:e.jsx("div",{className:"detail_info_wrapper",children:e.jsxs(N,{method:"post",id:"contact-form",children:[e.jsx("p",{className:"form-row",children:e.jsxs("div",{className:"form-row-wrapper",children:[e.jsx("span",{className:"form-label",children:"Name"}),e.jsx(f,{size:"xl",placeholder:"First","aria-label":"First name",type:"text",name:"first",defaultValue:a.first}),e.jsx(f,{className:" ml-4",size:"xl",placeholder:"Last","aria-label":"Last name",type:"text",name:"last",defaultValue:a.last})]})}),e.jsx("p",{className:"form-row",children:e.jsxs("label",{className:"form-row-wrapper",children:[e.jsx("span",{className:"form-label",children:"Twitter"}),e.jsx(f,{size:"xl",type:"text",name:"twitter",placeholder:"@Twitter",defaultValue:a.twitter})]})}),e.jsx("p",{className:"form-row",children:e.jsxs("label",{className:"form-row-wrapper",children:[e.jsx("span",{className:"form-label",children:"Avatar URL"}),e.jsx(f,{size:"xl",placeholder:"Avatar URL","aria-label":"Avatar URL",type:"text",name:"avatar",defaultValue:a.avatar})]})}),e.jsx("p",{className:"form-row",children:e.jsxs("label",{className:"form-row-wrapper",children:[e.jsx("span",{className:"form-label",children:"Notes"}),e.jsx("textarea",{className:" w-full  text-contrast2",name:"notes",defaultValue:a.notes,placeholder:"Notes",rows:6})]})}),e.jsx("p",{className:"form-row btn-row",children:e.jsxs("div",{className:"form-row-wrapper",children:[e.jsx("span",{className:"form-label"}),e.jsx(g,{type:"submit",size:"xl",className:"text-contrast2",children:"Save"}),e.jsx(g,{type:"button",size:"xl",className:"ml-4 text-contrast2",onClick:()=>{s(-1)},children:"Cancel"})]})})]})})})}async function ue({params:a}){return await V(a.contactId),$("/")}function xe(){return e.jsx("div",{className:"section_index_page bg-transparent",children:e.jsxs("h2",{className:"section_heading_normalcase",children:[e.jsx("b",{children:"Directory:"})," Provides a glossary of your B2B customer contact information, streamlining communication. While this serves as a proof-of-concept for a contact directory, its underlying layout can be adapted to encompass a wider range of functionalities.  This includes the management of merchandise information, product categorization, and establishing associations between different data points."]})})}function fe(){return e.jsx("div",{className:"section_index_page bg-transparent",children:e.jsxs("h2",{className:"section_heading_normalcase",children:[e.jsx("b",{children:"Best Sellers:"})," Leverage Shopify's ",e.jsx("a",{href:"https://shopify.dev/docs/api/storefront",children:" GraphQL Storefront API "})," to retrieve real-time product data and identify your top-performing items. This product list goes beyond what a basic Shopify store offers. By leveraging the data you gather, you can tailor it into a format that enhances the customer experience. Imagine curated collections, personalized recommendations, or dynamic product displays based on browsing behavior –  all features unavailable in the default Shopify setup."]})})}function je(){var r,l,o,c,n,i,h;const{products:a}=v(d=>d.products),{handle:s}=A();let t=a.filter(d=>d.handle===s)[0];return e.jsx("div",{id:"product_detail",className:"detail_section",children:t!=null?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"detail_img_wrapper",children:e.jsx("img",{className:"detail_img_main",srcset:`
                ${(c=(o=(l=(r=t==null?void 0:t.media)==null?void 0:r.edges[0])==null?void 0:l.node)==null?void 0:o.previewImage)==null?void 0:c.transformedSrc} 480w,
                ${(n=t==null?void 0:t.featuredImage)==null?void 0:n.originalSrc} 800w
              `,sizes:"(max-width: 500px) 480px, 100vw",src:`${(i=t==null?void 0:t.featuredImage)==null?void 0:i.originalSrc}`,loading:"lazy"})}),e.jsxs("div",{className:"detail_info_wrapper",children:[e.jsx("h1",{className:"section_heading",children:t.title}),e.jsx("div",{className:"handle ",children:e.jsx("span",{className:"num_format_box",children:t.handle})}),e.jsx("div",{className:"description py-10",children:t.description}),e.jsxs("div",{className:"list_section variants",children:[e.jsx("h2",{className:"list_title",children:"Variants: "}),e.jsx("ul",{children:(h=t==null?void 0:t.variants)==null?void 0:h.edges.map(d=>{let p=d.node,u=p.id.replace("gid://shopify/ProductVariant/",""),x=p.selectedOptions[0];return e.jsxs("li",{className:"variantItem",children:[e.jsx("span",{className:"vid num_format_box",children:u}),e.jsx("span",{className:"selectedOption uppercase num_format_box",children:`${x.name}/${x.value}`})]},u)})})]})]})]}):e.jsx("div",{children:" no product match the param "})})}function ge(){return v(a=>a.customers),e.jsx("div",{className:"customerIndex section_index_page bg-transparent",children:e.jsxs("h2",{className:"section_heading_normalcase",children:[e.jsx("b",{children:"Purchase History:"})," To securely fetch data that's accessible exclusively via the admin API without exposing the API key, we must create a custom app utilizing ",e.jsx("a",{href:"https://shopify.dev/docs/api/shopify-app-remix/v2/authenticate/public/app-proxy",children:" Shopify's App Proxy"}),". This approach involves the frontend making the data requests to an Remix endpoint, reserved for the proxy, which then securely calls the ",e.jsx("a",{href:"https://shopify.dev/docs/api/admin-graphql",children:" GraphQL admin API "})," on Shopify server. This intermediary layer effectively ",e.jsx("a",{href:"https://shopify.dev/docs/apps/build/authentication-authorization/access-tokens/generate-app-access-tokens-admin",children:"safeguards"})," the admin API key."]})})}function ve(){var l;const{customers:a}=v(o=>o.customers),{customerId:s}=A();let t=a.filter(o=>o.id.replace("gid://shopify/Customer/","")===s?o:"")[0];const r=m.useMemo(()=>se(t),[t]);return e.jsx("div",{id:"customer_detail",className:"detail_section",children:t!=null?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"detail_info_wrapper",children:[e.jsx("h1",{className:"section_heading",children:`${t.firstName} ${t.lastName}`}),e.jsxs("div",{className:"totalSpending",children:["Total Spending: ",e.jsxs("span",{className:"num_format_box bg-green-700",children:["$",r]})]}),e.jsx("div",{className:"description",children:t.description}),e.jsxs("div",{className:"list_section",children:[e.jsx("h2",{className:"list_title",children:"Orders: "}),e.jsx("ul",{children:(l=t==null?void 0:t.orders)==null?void 0:l.edges.map(o=>{let c=o.node,n=c.lineItems.nodes;return e.jsxs("li",{className:"listItem orderItem",children:[e.jsxs("div",{className:"orderHeader",children:[e.jsx("span",{className:"orderNum num_format_box",children:c.name})," ",e.jsx("span",{className:"orderDate num_format_box",children:re(c.createdAt)})," ",e.jsxs("span",{className:"totalprice num_format_box",children:["$",c.totalPrice]})]}),e.jsx("div",{className:"orderBody",children:e.jsx("ul",{children:n.map(i=>{var d,p,u,x,w,_;const h=(_=(w=(x=(u=(p=(d=i==null?void 0:i.product)==null?void 0:d.media)==null?void 0:p.edges[0])==null?void 0:u.node)==null?void 0:x.preview)==null?void 0:w.image)==null?void 0:_.transformedSrc;return e.jsxs("li",{className:"order_lineItem",children:[e.jsx("span",{className:"lineItem_img_wrapper",children:e.jsx("img",{className:"lineItem_img_main",src:h})}),e.jsx("span",{className:"lineItem_info num_format_box border-none",children:`${i.name} / qty:${i.quantity}`})]},`${h}-${R()}`)})})})]},`${o.id}-${R()}`)})})]})]})}):e.jsx("div",{children:" no customer match the param "})})}const Ne=H([{path:"/",element:e.jsx(Q,{}),errorElement:e.jsx(I,{}),loader:oe,action:G,children:[{errorElement:e.jsx(I,{}),children:[{index:!0,path:"contacts",element:e.jsx(xe,{}),loader:ie},{path:"contacts/:contactId",element:e.jsx(de,{}),loader:S,action:le},{path:"contacts/:contactId/edit",element:e.jsx(pe,{}),loader:S,action:he},{path:"contacts/:contactId/destroy",action:ue,errorElement:e.jsx("div",{children:"Oops! There was an error."})},{path:"products",element:e.jsx(fe,{})},{path:"products/:handle",element:e.jsx(je,{})},{path:"customers",element:e.jsx(ge,{})},{path:"customers/:customerId",element:e.jsx(ve,{})}]}]},{path:"*",element:e.jsx(M,{to:"/",replace:!0})}]),ye=()=>e.jsx(D.StrictMode,{children:e.jsx(W,{store:ne,children:e.jsx(Y,{router:Ne})})}),we=y.createRoot(document.getElementById(j));we.render(e.jsx(ye,{}));
